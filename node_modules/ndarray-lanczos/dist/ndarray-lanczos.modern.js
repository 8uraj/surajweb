import t from"ndarray";const e=(t,e)=>{if(t<=-e||t>=e)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;const n=t*Math.PI;return Math.sin(n)/n*Math.sin(n/e)/(n/e)},n=(t,n,r,a,o,s,c,h)=>{const l=2**h-1,i=t=>Math.round(t*l),p=o?2:3,u=1/r,f=Math.min(1,r),d=p/f,_=new c((Math.floor(2*(d+1))+2)*n);let y=0;for(let r=0;r<n;r++){const o=(r+.5)*u+a,h=Math.max(0,Math.floor(o-d)),l=Math.min(t-1,Math.ceil(o+d)),A=l-h+1,E=new s(A),M=new c(A);let g=0,L=0;for(let t=h;t<=l;t++){const n=e((t+.5-o)*f,p);g+=n,E[L]=n,L++}let N=0;for(let t=0;t<E.length;t++){const e=E[t]/g;N+=e,M[t]=i(e)}M[n>>1]+=i(1-N);let S=0;for(;S<M.length&&0===M[S];)S++;let w=M.length-1;for(;w>0&&0===M[w];)w--;const m=w-S+1;_[y++]=h+S,_[y++]=m,_.set(M.subarray(S,w+1),y),y+=m}return _},r=(t,e,n,r)=>{const[a,o]=t.shape,[s]=e.shape,c=2**(8*e.data.BYTES_PER_ELEMENT)-1,h=t=>t<0?0:t>c?c:t,l=2**(r-1),i=2*l;for(let r=0;r<o;r++){const a=r;let o=0;for(let c=0;c<s;c++){let s=n[o++],p=0,u=0,f=0,d=0;for(let e=n[o++];e>0;e--){const e=n[o++];p+=e*t.get(s,r,0),u+=e*t.get(s,r,1),f+=e*t.get(s,r,2),d+=e*t.get(s,r,3),s++}e.set(c,a,0,h((p+l)/i)),e.set(c,a,1,h((u+l)/i)),e.set(c,a,2,h((f+l)/i)),e.set(c,a,3,h((d+l)/i))}}};var a;function o(e,o,s){if(3!==e.shape.length||3!==o.shape.length)throw new TypeError("Input and output must have exactly 3 dimensions (width, height and colorspace)");const[c,h]=e.shape,[l,i]=o.shape,p=l/c,u=i/h;let f,d;switch(o.dtype){case"uint8_clamped":case"uint8":f=Float32Array,d=Int16Array;break;case"uint16":case"uint32":f=Float64Array,d=Int32Array;break;default:throw TypeError(`Unsupported data type ${o.dtype}`)}const _=7*d.BYTES_PER_ELEMENT,y=n(c,l,p,0,s===a.LANCZOS_2,f,d,_),A=n(h,i,u,0,s===a.LANCZOS_2,f,d,_),E=t(new(0,o.data.constructor)(l*h*4),[h,l,4]),M=E.transpose(1,0),g=o.transpose(1,0);r(e,M,y,_),r(E,g,A,_)}function s(t,e){o(t,e,a.LANCZOS_3)}function c(t,e){o(t,e,a.LANCZOS_2)}!function(t){t[t.LANCZOS_3=3]="LANCZOS_3",t[t.LANCZOS_2=2]="LANCZOS_2"}(a||(a={}));export{c as lanczos2,s as lanczos3};
//# sourceMappingURL=ndarray-lanczos.modern.js.map
